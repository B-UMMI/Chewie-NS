{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nimport HttpError from './HttpError';\nimport { stringify } from 'query-string';\nexport var createHeadersFromOptions = function (options) {\n  var requestHeaders = options.headers || new Headers({\n    Accept: 'application/json'\n  });\n\n  if (!requestHeaders.has('Content-Type') && !(options && (!options.method || options.method === 'GET')) && !(options && options.body && options.body instanceof FormData)) {\n    requestHeaders.set('Content-Type', 'application/json');\n  }\n\n  if (options.user && options.user.authenticated && options.user.token) {\n    requestHeaders.set('Authorization', options.user.token);\n  }\n\n  return requestHeaders;\n};\nexport var fetchJson = function (url, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var requestHeaders = createHeadersFromOptions(options);\n  return fetch(url, __assign(__assign({}, options), {\n    headers: requestHeaders\n  })).then(function (response) {\n    return response.text().then(function (text) {\n      return {\n        status: response.status,\n        statusText: response.statusText,\n        headers: response.headers,\n        body: text\n      };\n    });\n  }).then(function (_a) {\n    var status = _a.status,\n        statusText = _a.statusText,\n        headers = _a.headers,\n        body = _a.body;\n    var json;\n\n    try {\n      json = JSON.parse(body);\n    } catch (e) {// not json, no big deal\n    }\n\n    if (status < 200 || status >= 300) {\n      return Promise.reject(new HttpError(json && json.message || statusText, status, json));\n    }\n\n    return Promise.resolve({\n      status: status,\n      headers: headers,\n      body: body,\n      json: json\n    });\n  });\n};\nexport var queryParameters = stringify;\n\nvar isValidObject = function (value) {\n  if (!value) {\n    return false;\n  }\n\n  var isArray = Array.isArray(value);\n  var isBuffer = typeof Buffer !== 'undefined' && Buffer.isBuffer(value);\n  var isObject = Object.prototype.toString.call(value) === '[object Object]';\n  var hasKeys = !!Object.keys(value).length;\n  return !isArray && !isBuffer && isObject && hasKeys;\n};\n\nexport var flattenObject = function (value, path) {\n  var _a;\n\n  if (path === void 0) {\n    path = [];\n  }\n\n  if (isValidObject(value)) {\n    return Object.assign.apply(Object, __spreadArrays([{}], Object.keys(value).map(function (key) {\n      return flattenObject(value[key], path.concat([key]));\n    })));\n  } else {\n    return path.length ? (_a = {}, _a[path.join('.')] = value, _a) : value;\n  }\n};","map":{"version":3,"sources":["/node_modules/ra-core/esm/dataProvider/fetch.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArrays","il","r","Array","k","a","j","jl","HttpError","stringify","createHeadersFromOptions","options","requestHeaders","headers","Headers","Accept","has","method","body","FormData","set","user","authenticated","token","fetchJson","url","fetch","then","response","text","status","statusText","_a","json","JSON","parse","e","Promise","reject","message","resolve","queryParameters","isValidObject","value","isArray","isBuffer","Buffer","isObject","toString","hasKeys","keys","flattenObject","path","map","key","concat","join"],"mappings":"AAAA,IAAIA,QAAQ,GAAI,QAAQ,KAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAASC,CAAT,EAAY;AACpC,SAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,WAAK,IAAII,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EACbN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACP;;AACD,WAAON,CAAP;AACH,GAPD;;AAQA,SAAOH,QAAQ,CAACa,KAAT,CAAe,IAAf,EAAqBN,SAArB,CAAP;AACH,CAVD;;AAWA,IAAIO,cAAc,GAAI,QAAQ,KAAKA,cAAd,IAAiC,YAAY;AAC9D,OAAK,IAAIV,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAG,CAAf,EAAkBU,EAAE,GAAGR,SAAS,CAACC,MAAtC,EAA8CH,CAAC,GAAGU,EAAlD,EAAsDV,CAAC,EAAvD,EAA2DD,CAAC,IAAIG,SAAS,CAACF,CAAD,CAAT,CAAaG,MAAlB;;AAC3D,OAAK,IAAIQ,CAAC,GAAGC,KAAK,CAACb,CAAD,CAAb,EAAkBc,CAAC,GAAG,CAAtB,EAAyBb,CAAC,GAAG,CAAlC,EAAqCA,CAAC,GAAGU,EAAzC,EAA6CV,CAAC,EAA9C,EACI,KAAK,IAAIc,CAAC,GAAGZ,SAAS,CAACF,CAAD,CAAjB,EAAsBe,CAAC,GAAG,CAA1B,EAA6BC,EAAE,GAAGF,CAAC,CAACX,MAAzC,EAAiDY,CAAC,GAAGC,EAArD,EAAyDD,CAAC,IAAIF,CAAC,EAA/D,EACIF,CAAC,CAACE,CAAD,CAAD,GAAOC,CAAC,CAACC,CAAD,CAAR;;AACR,SAAOJ,CAAP;AACH,CAND;;AAOA,OAAOM,SAAP,MAAsB,aAAtB;AACA,SAASC,SAAT,QAA0B,cAA1B;AACA,OAAO,IAAIC,wBAAwB,GAAG,UAAUC,OAAV,EAAmB;AACrD,MAAIC,cAAc,GAAID,OAAO,CAACE,OAAR,IAClB,IAAIC,OAAJ,CAAY;AACRC,IAAAA,MAAM,EAAE;AADA,GAAZ,CADJ;;AAIA,MAAI,CAACH,cAAc,CAACI,GAAf,CAAmB,cAAnB,CAAD,IACA,EAAEL,OAAO,KAAK,CAACA,OAAO,CAACM,MAAT,IAAmBN,OAAO,CAACM,MAAR,KAAmB,KAA3C,CAAT,CADA,IAEA,EAAEN,OAAO,IAAIA,OAAO,CAACO,IAAnB,IAA2BP,OAAO,CAACO,IAAR,YAAwBC,QAArD,CAFJ,EAEoE;AAChEP,IAAAA,cAAc,CAACQ,GAAf,CAAmB,cAAnB,EAAmC,kBAAnC;AACH;;AACD,MAAIT,OAAO,CAACU,IAAR,IAAgBV,OAAO,CAACU,IAAR,CAAaC,aAA7B,IAA8CX,OAAO,CAACU,IAAR,CAAaE,KAA/D,EAAsE;AAClEX,IAAAA,cAAc,CAACQ,GAAf,CAAmB,eAAnB,EAAoCT,OAAO,CAACU,IAAR,CAAaE,KAAjD;AACH;;AACD,SAAOX,cAAP;AACH,CAdM;AAeP,OAAO,IAAIY,SAAS,GAAG,UAAUC,GAAV,EAAed,OAAf,EAAwB;AAC3C,MAAIA,OAAO,KAAK,KAAK,CAArB,EAAwB;AAAEA,IAAAA,OAAO,GAAG,EAAV;AAAe;;AACzC,MAAIC,cAAc,GAAGF,wBAAwB,CAACC,OAAD,CAA7C;AACA,SAAOe,KAAK,CAACD,GAAD,EAAMvC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKyB,OAAL,CAAT,EAAwB;AAAEE,IAAAA,OAAO,EAAED;AAAX,GAAxB,CAAd,CAAL,CACFe,IADE,CACG,UAAUC,QAAV,EAAoB;AAC1B,WAAOA,QAAQ,CAACC,IAAT,GAAgBF,IAAhB,CAAqB,UAAUE,IAAV,EAAgB;AAAE,aAAQ;AAClDC,QAAAA,MAAM,EAAEF,QAAQ,CAACE,MADiC;AAElDC,QAAAA,UAAU,EAAEH,QAAQ,CAACG,UAF6B;AAGlDlB,QAAAA,OAAO,EAAEe,QAAQ,CAACf,OAHgC;AAIlDK,QAAAA,IAAI,EAAEW;AAJ4C,OAAR;AAKzC,KALE,CAAP;AAMH,GARM,EASFF,IATE,CASG,UAAUK,EAAV,EAAc;AACpB,QAAIF,MAAM,GAAGE,EAAE,CAACF,MAAhB;AAAA,QAAwBC,UAAU,GAAGC,EAAE,CAACD,UAAxC;AAAA,QAAoDlB,OAAO,GAAGmB,EAAE,CAACnB,OAAjE;AAAA,QAA0EK,IAAI,GAAGc,EAAE,CAACd,IAApF;AACA,QAAIe,IAAJ;;AACA,QAAI;AACAA,MAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWjB,IAAX,CAAP;AACH,KAFD,CAGA,OAAOkB,CAAP,EAAU,CACN;AACH;;AACD,QAAIN,MAAM,GAAG,GAAT,IAAgBA,MAAM,IAAI,GAA9B,EAAmC;AAC/B,aAAOO,OAAO,CAACC,MAAR,CAAe,IAAI9B,SAAJ,CAAeyB,IAAI,IAAIA,IAAI,CAACM,OAAd,IAA0BR,UAAxC,EAAoDD,MAApD,EAA4DG,IAA5D,CAAf,CAAP;AACH;;AACD,WAAOI,OAAO,CAACG,OAAR,CAAgB;AAAEV,MAAAA,MAAM,EAAEA,MAAV;AAAkBjB,MAAAA,OAAO,EAAEA,OAA3B;AAAoCK,MAAAA,IAAI,EAAEA,IAA1C;AAAgDe,MAAAA,IAAI,EAAEA;AAAtD,KAAhB,CAAP;AACH,GAtBM,CAAP;AAuBH,CA1BM;AA2BP,OAAO,IAAIQ,eAAe,GAAGhC,SAAtB;;AACP,IAAIiC,aAAa,GAAG,UAAUC,KAAV,EAAiB;AACjC,MAAI,CAACA,KAAL,EAAY;AACR,WAAO,KAAP;AACH;;AACD,MAAIC,OAAO,GAAGzC,KAAK,CAACyC,OAAN,CAAcD,KAAd,CAAd;AACA,MAAIE,QAAQ,GAAG,OAAOC,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACD,QAAP,CAAgBF,KAAhB,CAAhD;AACA,MAAII,QAAQ,GAAG5D,MAAM,CAACS,SAAP,CAAiBoD,QAAjB,CAA0BlD,IAA1B,CAA+B6C,KAA/B,MAA0C,iBAAzD;AACA,MAAIM,OAAO,GAAG,CAAC,CAAC9D,MAAM,CAAC+D,IAAP,CAAYP,KAAZ,EAAmBjD,MAAnC;AACA,SAAO,CAACkD,OAAD,IAAY,CAACC,QAAb,IAAyBE,QAAzB,IAAqCE,OAA5C;AACH,CATD;;AAUA,OAAO,IAAIE,aAAa,GAAG,UAAUR,KAAV,EAAiBS,IAAjB,EAAuB;AAC9C,MAAIpB,EAAJ;;AACA,MAAIoB,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,IAAAA,IAAI,GAAG,EAAP;AAAY;;AACnC,MAAIV,aAAa,CAACC,KAAD,CAAjB,EAA0B;AACtB,WAAOxD,MAAM,CAACC,MAAP,CAAcW,KAAd,CAAoBZ,MAApB,EAA4Ba,cAAc,CAAC,CAAC,EAAD,CAAD,EAAOb,MAAM,CAAC+D,IAAP,CAAYP,KAAZ,EAAmBU,GAAnB,CAAuB,UAAUC,GAAV,EAAe;AAC1F,aAAOH,aAAa,CAACR,KAAK,CAACW,GAAD,CAAN,EAAaF,IAAI,CAACG,MAAL,CAAY,CAACD,GAAD,CAAZ,CAAb,CAApB;AACH,KAFuD,CAAP,CAA1C,CAAP;AAGH,GAJD,MAKK;AACD,WAAOF,IAAI,CAAC1D,MAAL,IAAesC,EAAE,GAAG,EAAL,EAASA,EAAE,CAACoB,IAAI,CAACI,IAAL,CAAU,GAAV,CAAD,CAAF,GAAqBb,KAA9B,EAAqCX,EAApD,IAA0DW,KAAjE;AACH;AACJ,CAXM","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport HttpError from './HttpError';\nimport { stringify } from 'query-string';\nexport var createHeadersFromOptions = function (options) {\n    var requestHeaders = (options.headers ||\n        new Headers({\n            Accept: 'application/json',\n        }));\n    if (!requestHeaders.has('Content-Type') &&\n        !(options && (!options.method || options.method === 'GET')) &&\n        !(options && options.body && options.body instanceof FormData)) {\n        requestHeaders.set('Content-Type', 'application/json');\n    }\n    if (options.user && options.user.authenticated && options.user.token) {\n        requestHeaders.set('Authorization', options.user.token);\n    }\n    return requestHeaders;\n};\nexport var fetchJson = function (url, options) {\n    if (options === void 0) { options = {}; }\n    var requestHeaders = createHeadersFromOptions(options);\n    return fetch(url, __assign(__assign({}, options), { headers: requestHeaders }))\n        .then(function (response) {\n        return response.text().then(function (text) { return ({\n            status: response.status,\n            statusText: response.statusText,\n            headers: response.headers,\n            body: text,\n        }); });\n    })\n        .then(function (_a) {\n        var status = _a.status, statusText = _a.statusText, headers = _a.headers, body = _a.body;\n        var json;\n        try {\n            json = JSON.parse(body);\n        }\n        catch (e) {\n            // not json, no big deal\n        }\n        if (status < 200 || status >= 300) {\n            return Promise.reject(new HttpError((json && json.message) || statusText, status, json));\n        }\n        return Promise.resolve({ status: status, headers: headers, body: body, json: json });\n    });\n};\nexport var queryParameters = stringify;\nvar isValidObject = function (value) {\n    if (!value) {\n        return false;\n    }\n    var isArray = Array.isArray(value);\n    var isBuffer = typeof Buffer !== 'undefined' && Buffer.isBuffer(value);\n    var isObject = Object.prototype.toString.call(value) === '[object Object]';\n    var hasKeys = !!Object.keys(value).length;\n    return !isArray && !isBuffer && isObject && hasKeys;\n};\nexport var flattenObject = function (value, path) {\n    var _a;\n    if (path === void 0) { path = []; }\n    if (isValidObject(value)) {\n        return Object.assign.apply(Object, __spreadArrays([{}], Object.keys(value).map(function (key) {\n            return flattenObject(value[key], path.concat([key]));\n        })));\n    }\n    else {\n        return path.length ? (_a = {}, _a[path.join('.')] = value, _a) : value;\n    }\n};\n"]},"metadata":{},"sourceType":"module"}