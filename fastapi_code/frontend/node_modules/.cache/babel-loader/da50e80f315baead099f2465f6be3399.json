{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport get from 'lodash/get';\nimport { useCallback, useEffect, useRef } from 'react';\nimport isEqual from 'lodash/isEqual';\nimport { useSafeSetState, removeEmpty } from '../../util';\nimport { useGetManyReference } from '../../dataProvider';\nimport { useNotify } from '../../sideEffect';\nimport usePaginationState from '../usePaginationState';\nimport useSelectionState from '../useSelectionState';\nimport useSortState from '../useSortState';\nvar defaultFilter = {};\n/**\n * Fetch reference records, and return them when avaliable\n *\n * The reference prop sould be the name of one of the <Resource> components\n * added as <Admin> child.\n *\n * @example\n *\n * const { loaded, referenceRecord, resourceLinkPath } = useReferenceManyFieldController({\n *     resource\n *     reference: 'users',\n *     record: {\n *         userId: 7\n *     }\n *     target: 'comments',\n *     source: 'userId',\n *     basePath: '/comments',\n *     page: 1,\n *     perPage: 25,\n * });\n *\n * @param {Object} option\n * @param {string} option.resource The current resource name\n * @param {string} option.reference The linked resource name\n * @param {Object} option.record The current resource record\n * @param {string} option.target The target resource key\n * @param {Object} option.filter The filter applied on the recorded records list\n * @param {string} option.source The key of the linked resource identifier\n * @param {string} option.basePath basepath to current resource\n * @param {number} option.page the page number\n * @param {number} option.perPage the number of item per page\n * @param {Object} option.sort the sort to apply to the referenced records\n *\n * @returns {ReferenceManyProps} The reference many props\n */\n\nvar useReferenceManyFieldController = function (_a) {\n  var resource = _a.resource,\n      reference = _a.reference,\n      record = _a.record,\n      target = _a.target,\n      _b = _a.filter,\n      filter = _b === void 0 ? defaultFilter : _b,\n      source = _a.source,\n      basePath = _a.basePath,\n      initialPage = _a.page,\n      initialPerPage = _a.perPage,\n      _c = _a.sort,\n      initialSort = _c === void 0 ? {\n    field: 'id',\n    order: 'DESC'\n  } : _c;\n  var notify = useNotify(); // pagination logic\n\n  var _d = usePaginationState({\n    page: initialPage,\n    perPage: initialPerPage\n  }),\n      page = _d.page,\n      setPage = _d.setPage,\n      perPage = _d.perPage,\n      setPerPage = _d.setPerPage; // sort logic\n\n\n  var _e = useSortState(initialSort),\n      sort = _e.sort,\n      setSortObject = _e.setSort;\n\n  var setSort = useCallback(function (field, order) {\n    if (order === void 0) {\n      order = 'ASC';\n    }\n\n    setSortObject({\n      field: field,\n      order: order\n    });\n    setPage(1);\n  }, [setPage, setSortObject]); // selection logic\n\n  var _f = useSelectionState(),\n      selectedIds = _f.selectedIds,\n      onSelect = _f.onSelect,\n      onToggleItem = _f.onToggleItem,\n      onUnselectItems = _f.onUnselectItems; // filter logic\n\n\n  var filterRef = useRef(filter);\n\n  var _g = useSafeSetState({}),\n      displayedFilters = _g[0],\n      setDisplayedFilters = _g[1];\n\n  var _h = useSafeSetState(filter),\n      filterValues = _h[0],\n      setFilterValues = _h[1];\n\n  var hideFilter = useCallback(function (filterName) {\n    setDisplayedFilters(function (previousState) {\n      var _a = previousState,\n          _b = filterName,\n          _ = _a[_b],\n          newState = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n\n      return newState;\n    });\n    setFilterValues(function (previousState) {\n      var _a = previousState,\n          _b = filterName,\n          _ = _a[_b],\n          newState = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n\n      return newState;\n    });\n  }, [setDisplayedFilters, setFilterValues]);\n  var showFilter = useCallback(function (filterName, defaultValue) {\n    setDisplayedFilters(function (previousState) {\n      var _a;\n\n      return __assign(__assign({}, previousState), (_a = {}, _a[filterName] = true, _a));\n    });\n    setFilterValues(function (previousState) {\n      var _a;\n\n      return __assign(__assign({}, previousState), (_a = {}, _a[filterName] = defaultValue, _a));\n    });\n  }, [setDisplayedFilters, setFilterValues]);\n  var setFilters = useCallback(function (filters, displayedFilters) {\n    setFilterValues(removeEmpty(filters));\n    setDisplayedFilters(displayedFilters);\n    setPage(1);\n  }, [setDisplayedFilters, setFilterValues, setPage]); // handle filter prop change\n\n  useEffect(function () {\n    if (!isEqual(filter, filterRef.current)) {\n      filterRef.current = filter;\n      setFilterValues(filter);\n    }\n  });\n  var referenceId = get(record, source);\n\n  var _j = useGetManyReference(reference, target, referenceId, {\n    page: page,\n    perPage: perPage\n  }, sort, filterValues, resource, {\n    onFailure: function (error) {\n      return notify(typeof error === 'string' ? error : error.message || 'ra.notification.http_error', 'warning');\n    }\n  }),\n      data = _j.data,\n      ids = _j.ids,\n      total = _j.total,\n      error = _j.error,\n      loading = _j.loading,\n      loaded = _j.loaded;\n\n  return {\n    basePath: basePath.replace(resource, reference),\n    currentSort: sort,\n    data: data,\n    defaultTitle: null,\n    displayedFilters: displayedFilters,\n    error: error,\n    filterValues: filterValues,\n    hasCreate: false,\n    hideFilter: hideFilter,\n    ids: ids,\n    loaded: loaded,\n    loading: loading,\n    onSelect: onSelect,\n    onToggleItem: onToggleItem,\n    onUnselectItems: onUnselectItems,\n    page: page,\n    perPage: perPage,\n    resource: reference,\n    selectedIds: selectedIds,\n    setFilters: setFilters,\n    setPage: setPage,\n    setPerPage: setPerPage,\n    setSort: setSort,\n    showFilter: showFilter,\n    total: total\n  };\n};\n\nexport default useReferenceManyFieldController;","map":{"version":3,"sources":["/node_modules/ra-core/esm/controller/field/useReferenceManyFieldController.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","get","useCallback","useEffect","useRef","isEqual","useSafeSetState","removeEmpty","useGetManyReference","useNotify","usePaginationState","useSelectionState","useSortState","defaultFilter","useReferenceManyFieldController","_a","resource","reference","record","target","_b","filter","source","basePath","initialPage","page","initialPerPage","perPage","_c","sort","initialSort","field","order","notify","_d","setPage","setPerPage","_e","setSortObject","setSort","_f","selectedIds","onSelect","onToggleItem","onUnselectItems","filterRef","_g","displayedFilters","setDisplayedFilters","_h","filterValues","setFilterValues","hideFilter","filterName","previousState","_","newState","showFilter","defaultValue","setFilters","filters","current","referenceId","_j","onFailure","error","message","data","ids","total","loading","loaded","replace","currentSort","defaultTitle","hasCreate"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport get from 'lodash/get';\nimport { useCallback, useEffect, useRef } from 'react';\nimport isEqual from 'lodash/isEqual';\nimport { useSafeSetState, removeEmpty } from '../../util';\nimport { useGetManyReference } from '../../dataProvider';\nimport { useNotify } from '../../sideEffect';\nimport usePaginationState from '../usePaginationState';\nimport useSelectionState from '../useSelectionState';\nimport useSortState from '../useSortState';\nvar defaultFilter = {};\n/**\n * Fetch reference records, and return them when avaliable\n *\n * The reference prop sould be the name of one of the <Resource> components\n * added as <Admin> child.\n *\n * @example\n *\n * const { loaded, referenceRecord, resourceLinkPath } = useReferenceManyFieldController({\n *     resource\n *     reference: 'users',\n *     record: {\n *         userId: 7\n *     }\n *     target: 'comments',\n *     source: 'userId',\n *     basePath: '/comments',\n *     page: 1,\n *     perPage: 25,\n * });\n *\n * @param {Object} option\n * @param {string} option.resource The current resource name\n * @param {string} option.reference The linked resource name\n * @param {Object} option.record The current resource record\n * @param {string} option.target The target resource key\n * @param {Object} option.filter The filter applied on the recorded records list\n * @param {string} option.source The key of the linked resource identifier\n * @param {string} option.basePath basepath to current resource\n * @param {number} option.page the page number\n * @param {number} option.perPage the number of item per page\n * @param {Object} option.sort the sort to apply to the referenced records\n *\n * @returns {ReferenceManyProps} The reference many props\n */\nvar useReferenceManyFieldController = function (_a) {\n    var resource = _a.resource, reference = _a.reference, record = _a.record, target = _a.target, _b = _a.filter, filter = _b === void 0 ? defaultFilter : _b, source = _a.source, basePath = _a.basePath, initialPage = _a.page, initialPerPage = _a.perPage, _c = _a.sort, initialSort = _c === void 0 ? { field: 'id', order: 'DESC' } : _c;\n    var notify = useNotify();\n    // pagination logic\n    var _d = usePaginationState({\n        page: initialPage,\n        perPage: initialPerPage,\n    }), page = _d.page, setPage = _d.setPage, perPage = _d.perPage, setPerPage = _d.setPerPage;\n    // sort logic\n    var _e = useSortState(initialSort), sort = _e.sort, setSortObject = _e.setSort;\n    var setSort = useCallback(function (field, order) {\n        if (order === void 0) { order = 'ASC'; }\n        setSortObject({ field: field, order: order });\n        setPage(1);\n    }, [setPage, setSortObject]);\n    // selection logic\n    var _f = useSelectionState(), selectedIds = _f.selectedIds, onSelect = _f.onSelect, onToggleItem = _f.onToggleItem, onUnselectItems = _f.onUnselectItems;\n    // filter logic\n    var filterRef = useRef(filter);\n    var _g = useSafeSetState({}), displayedFilters = _g[0], setDisplayedFilters = _g[1];\n    var _h = useSafeSetState(filter), filterValues = _h[0], setFilterValues = _h[1];\n    var hideFilter = useCallback(function (filterName) {\n        setDisplayedFilters(function (previousState) {\n            var _a = previousState, _b = filterName, _ = _a[_b], newState = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n            return newState;\n        });\n        setFilterValues(function (previousState) {\n            var _a = previousState, _b = filterName, _ = _a[_b], newState = __rest(_a, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n            return newState;\n        });\n    }, [setDisplayedFilters, setFilterValues]);\n    var showFilter = useCallback(function (filterName, defaultValue) {\n        setDisplayedFilters(function (previousState) {\n            var _a;\n            return (__assign(__assign({}, previousState), (_a = {}, _a[filterName] = true, _a)));\n        });\n        setFilterValues(function (previousState) {\n            var _a;\n            return (__assign(__assign({}, previousState), (_a = {}, _a[filterName] = defaultValue, _a)));\n        });\n    }, [setDisplayedFilters, setFilterValues]);\n    var setFilters = useCallback(function (filters, displayedFilters) {\n        setFilterValues(removeEmpty(filters));\n        setDisplayedFilters(displayedFilters);\n        setPage(1);\n    }, [setDisplayedFilters, setFilterValues, setPage]);\n    // handle filter prop change\n    useEffect(function () {\n        if (!isEqual(filter, filterRef.current)) {\n            filterRef.current = filter;\n            setFilterValues(filter);\n        }\n    });\n    var referenceId = get(record, source);\n    var _j = useGetManyReference(reference, target, referenceId, { page: page, perPage: perPage }, sort, filterValues, resource, {\n        onFailure: function (error) {\n            return notify(typeof error === 'string'\n                ? error\n                : error.message || 'ra.notification.http_error', 'warning');\n        },\n    }), data = _j.data, ids = _j.ids, total = _j.total, error = _j.error, loading = _j.loading, loaded = _j.loaded;\n    return {\n        basePath: basePath.replace(resource, reference),\n        currentSort: sort,\n        data: data,\n        defaultTitle: null,\n        displayedFilters: displayedFilters,\n        error: error,\n        filterValues: filterValues,\n        hasCreate: false,\n        hideFilter: hideFilter,\n        ids: ids,\n        loaded: loaded,\n        loading: loading,\n        onSelect: onSelect,\n        onToggleItem: onToggleItem,\n        onUnselectItems: onUnselectItems,\n        page: page,\n        perPage: perPage,\n        resource: reference,\n        selectedIds: selectedIds,\n        setFilters: setFilters,\n        setPage: setPage,\n        setPerPage: setPerPage,\n        setSort: setSort,\n        showFilter: showFilter,\n        total: total,\n    };\n};\nexport default useReferenceManyFieldController;\n"]},"metadata":{},"sourceType":"module"}