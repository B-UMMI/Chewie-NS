{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport { Children, cloneElement, isValidElement, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { CSSTransition, TransitionGroup } from 'react-transition-group';\nimport get from 'lodash/get';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CloseIcon from '@material-ui/icons/RemoveCircleOutline';\nimport AddIcon from '@material-ui/icons/AddCircleOutline';\nimport { useTranslate, ValidationError } from 'ra-core';\nimport classNames from 'classnames';\nimport FormInput from './FormInput';\nvar useStyles = makeStyles(function (theme) {\n  var _a, _b;\n\n  return {\n    root: {\n      padding: 0,\n      marginBottom: 0,\n      '& > li:last-child': {\n        borderBottom: 'none'\n      }\n    },\n    line: (_a = {\n      display: 'flex',\n      listStyleType: 'none',\n      borderBottom: \"solid 1px \" + theme.palette.divider\n    }, _a[theme.breakpoints.down('xs')] = {\n      display: 'block'\n    }, _a['&.fade-enter'] = {\n      opacity: 0.01,\n      transform: 'translateX(100vw)'\n    }, _a['&.fade-enter-active'] = {\n      opacity: 1,\n      transform: 'translateX(0)',\n      transition: 'all 500ms ease-in'\n    }, _a['&.fade-exit'] = {\n      opacity: 1,\n      transform: 'translateX(0)'\n    }, _a['&.fade-exit-active'] = {\n      opacity: 0.01,\n      transform: 'translateX(100vw)',\n      transition: 'all 500ms ease-in'\n    }, _a),\n    index: (_b = {\n      width: '3em',\n      paddingTop: '1em'\n    }, _b[theme.breakpoints.down('sm')] = {\n      display: 'none'\n    }, _b),\n    form: {\n      flex: 2\n    },\n    action: {\n      paddingTop: '0.5em'\n    },\n    leftIcon: {\n      marginRight: theme.spacing(1)\n    }\n  };\n}, {\n  name: 'RaSimpleFormIterator'\n});\n\nvar DefaultAddButton = function (props) {\n  var classes = useStyles(props);\n  var translate = useTranslate();\n  return React.createElement(Button, __assign({\n    size: \"small\"\n  }, props), React.createElement(AddIcon, {\n    className: classes.leftIcon\n  }), translate('ra.action.add'));\n};\n\nvar DefaultRemoveButton = function (props) {\n  var classes = useStyles(props);\n  var translate = useTranslate();\n  return React.createElement(Button, __assign({\n    size: \"small\"\n  }, props), React.createElement(CloseIcon, {\n    className: classes.leftIcon\n  }), translate('ra.action.remove'));\n};\n\nvar SimpleFormIterator = function (props) {\n  var _a = props.addButton,\n      addButton = _a === void 0 ? React.createElement(DefaultAddButton, null) : _a,\n      _b = props.removeButton,\n      removeButton = _b === void 0 ? React.createElement(DefaultRemoveButton, null) : _b,\n      basePath = props.basePath,\n      children = props.children,\n      fields = props.fields,\n      _c = props.meta,\n      error = _c.error,\n      submitFailed = _c.submitFailed,\n      record = props.record,\n      resource = props.resource,\n      source = props.source,\n      disableAdd = props.disableAdd,\n      disableRemove = props.disableRemove,\n      variant = props.variant,\n      margin = props.margin,\n      TransitionProps = props.TransitionProps,\n      defaultValue = props.defaultValue;\n  var classes = useStyles(props); // We need a unique id for each field for a proper enter/exit animation\n  // so we keep an internal map between the field position and an auto-increment id\n\n  var nextId = useRef(fields && fields.length ? fields.length : defaultValue ? defaultValue.length : 0); // We check whether we have a defaultValue (which must be an array) before checking\n  // the fields prop which will always be empty for a new record.\n  // Without it, our ids wouldn't match the default value and we would get key warnings\n  // on the CssTransition element inside our render method\n\n  var ids = useRef(nextId.current > 0 ? Array.from(Array(nextId.current).keys()) : []);\n\n  var removeField = function (index) {\n    return function () {\n      ids.current.splice(index, 1);\n      fields.remove(index);\n    };\n  }; // Returns a boolean to indicate whether to disable the remove button for certain fields.\n  // If disableRemove is a function, then call the function with the current record to\n  // determining if the button should be disabled. Otherwise, use a boolean property that\n  // enables or disables the button for all of the fields.\n\n\n  var disableRemoveField = function (record, disableRemove) {\n    if (typeof disableRemove === 'boolean') {\n      return disableRemove;\n    }\n\n    return disableRemove && disableRemove(record);\n  };\n\n  var addField = function () {\n    ids.current.push(nextId.current++);\n    fields.push(undefined);\n  }; // add field and call the onClick event of the button passed as addButton prop\n\n\n  var handleAddButtonClick = function (originalOnClickHandler) {\n    return function (event) {\n      addField();\n\n      if (originalOnClickHandler) {\n        originalOnClickHandler(event);\n      }\n    };\n  }; // remove field and call the onClick event of the button passed as removeButton prop\n\n\n  var handleRemoveButtonClick = function (originalOnClickHandler, index) {\n    return function (event) {\n      removeField(index)();\n\n      if (originalOnClickHandler) {\n        originalOnClickHandler(event);\n      }\n    };\n  };\n\n  var records = get(record, source);\n  return fields ? React.createElement(\"ul\", {\n    className: classes.root\n  }, submitFailed && typeof error !== 'object' && error && React.createElement(FormHelperText, {\n    error: true\n  }, React.createElement(ValidationError, {\n    error: error\n  })), React.createElement(TransitionGroup, {\n    component: null\n  }, fields.map(function (member, index) {\n    return React.createElement(CSSTransition, __assign({\n      key: ids.current[index],\n      timeout: 500,\n      classNames: \"fade\"\n    }, TransitionProps), React.createElement(\"li\", {\n      className: classes.line\n    }, React.createElement(Typography, {\n      variant: \"body1\",\n      className: classes.index\n    }, index + 1), React.createElement(\"section\", {\n      className: classes.form\n    }, Children.map(children, function (input, index2) {\n      return isValidElement(input) ? React.createElement(FormInput, {\n        basePath: input.props.basePath || basePath,\n        input: cloneElement(input, {\n          source: input.props.source ? member + \".\" + input.props.source : member,\n          index: input.props.source ? undefined : index2,\n          label: typeof input.props.label === 'undefined' ? input.props.source ? \"resources.\" + resource + \".fields.\" + input.props.source : undefined : input.props.label\n        }),\n        record: records && records[index] || {},\n        resource: resource,\n        variant: variant,\n        margin: margin\n      }) : null;\n    })), !disableRemoveField(records && records[index] || {}, disableRemove) && React.createElement(\"span\", {\n      className: classes.action\n    }, cloneElement(removeButton, {\n      onClick: handleRemoveButtonClick(removeButton.props.onClick, index),\n      className: classNames('button-remove', \"button-remove-\" + source + \"-\" + index)\n    }))));\n  })), !disableAdd && React.createElement(\"li\", {\n    className: classes.line\n  }, React.createElement(\"span\", {\n    className: classes.action\n  }, cloneElement(addButton, {\n    onClick: handleAddButtonClick(addButton.props.onClick),\n    className: classNames('button-add', \"button-add-\" + source)\n  })))) : null;\n};\n\nSimpleFormIterator.defaultProps = {\n  disableAdd: false,\n  disableRemove: false\n};\nSimpleFormIterator.propTypes = {\n  defaultValue: PropTypes.any,\n  addButton: PropTypes.element,\n  removeButton: PropTypes.element,\n  basePath: PropTypes.string,\n  children: PropTypes.node,\n  classes: PropTypes.object,\n  className: PropTypes.string,\n  // @ts-ignore\n  fields: PropTypes.object,\n  meta: PropTypes.object,\n  // @ts-ignore\n  record: PropTypes.object,\n  source: PropTypes.string,\n  resource: PropTypes.string,\n  translate: PropTypes.func,\n  disableAdd: PropTypes.bool,\n  disableRemove: PropTypes.oneOfType([PropTypes.func, PropTypes.bool]),\n  TransitionProps: PropTypes.shape({})\n};\nexport default SimpleFormIterator;","map":{"version":3,"sources":["/node_modules/ra-ui-materialui/esm/form/SimpleFormIterator.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","Children","cloneElement","isValidElement","useRef","PropTypes","CSSTransition","TransitionGroup","get","Typography","Button","FormHelperText","makeStyles","CloseIcon","AddIcon","useTranslate","ValidationError","classNames","FormInput","useStyles","theme","_a","_b","root","padding","marginBottom","borderBottom","line","display","listStyleType","palette","divider","breakpoints","down","opacity","transform","transition","index","width","paddingTop","form","flex","action","leftIcon","marginRight","spacing","name","DefaultAddButton","props","classes","translate","createElement","size","className","DefaultRemoveButton","SimpleFormIterator","addButton","removeButton","basePath","children","fields","_c","meta","error","submitFailed","record","resource","source","disableAdd","disableRemove","variant","margin","TransitionProps","defaultValue","nextId","ids","current","Array","from","keys","removeField","splice","remove","disableRemoveField","addField","push","undefined","handleAddButtonClick","originalOnClickHandler","event","handleRemoveButtonClick","records","component","map","member","key","timeout","input","index2","label","onClick","defaultProps","propTypes","any","element","string","node","object","func","bool","oneOfType","shape"],"mappings":"AAAA,IAAIA,QAAQ,GAAI,QAAQ,KAAKA,QAAd,IAA2B,YAAY;AAClDA,EAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAASC,CAAT,EAAY;AACpC,SAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,WAAK,IAAII,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EACbN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACP;;AACD,WAAON,CAAP;AACH,GAPD;;AAQA,SAAOH,QAAQ,CAACa,KAAT,CAAe,IAAf,EAAqBN,SAArB,CAAP;AACH,CAVD;;AAWA,OAAO,KAAKO,KAAZ,MAAuB,OAAvB;AACA,SAASC,QAAT,EAAmBC,YAAnB,EAAiCC,cAAjC,EAAiDC,MAAjD,QAAgE,OAAhE;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,SAASC,aAAT,EAAwBC,eAAxB,QAA+C,wBAA/C;AACA,OAAOC,GAAP,MAAgB,YAAhB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,cAAP,MAA2B,kCAA3B;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,OAAOC,SAAP,MAAsB,wCAAtB;AACA,OAAOC,OAAP,MAAoB,qCAApB;AACA,SAASC,YAAT,EAAuBC,eAAvB,QAA8C,SAA9C;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,IAAIC,SAAS,GAAGP,UAAU,CAAC,UAAUQ,KAAV,EAAiB;AACxC,MAAIC,EAAJ,EAAQC,EAAR;;AACA,SAAQ;AACJC,IAAAA,IAAI,EAAE;AACFC,MAAAA,OAAO,EAAE,CADP;AAEFC,MAAAA,YAAY,EAAE,CAFZ;AAGF,2BAAqB;AACjBC,QAAAA,YAAY,EAAE;AADG;AAHnB,KADF;AAQJC,IAAAA,IAAI,GAAGN,EAAE,GAAG;AACJO,MAAAA,OAAO,EAAE,MADL;AAEJC,MAAAA,aAAa,EAAE,MAFX;AAGJH,MAAAA,YAAY,EAAE,eAAeN,KAAK,CAACU,OAAN,CAAcC;AAHvC,KAAL,EAKHV,EAAE,CAACD,KAAK,CAACY,WAAN,CAAkBC,IAAlB,CAAuB,IAAvB,CAAD,CAAF,GAAmC;AAAEL,MAAAA,OAAO,EAAE;AAAX,KALhC,EAMHP,EAAE,CAAC,cAAD,CAAF,GAAqB;AACjBa,MAAAA,OAAO,EAAE,IADQ;AAEjBC,MAAAA,SAAS,EAAE;AAFM,KANlB,EAUHd,EAAE,CAAC,qBAAD,CAAF,GAA4B;AACxBa,MAAAA,OAAO,EAAE,CADe;AAExBC,MAAAA,SAAS,EAAE,eAFa;AAGxBC,MAAAA,UAAU,EAAE;AAHY,KAVzB,EAeHf,EAAE,CAAC,aAAD,CAAF,GAAoB;AAChBa,MAAAA,OAAO,EAAE,CADO;AAEhBC,MAAAA,SAAS,EAAE;AAFK,KAfjB,EAmBHd,EAAE,CAAC,oBAAD,CAAF,GAA2B;AACvBa,MAAAA,OAAO,EAAE,IADc;AAEvBC,MAAAA,SAAS,EAAE,mBAFY;AAGvBC,MAAAA,UAAU,EAAE;AAHW,KAnBxB,EAwBHf,EAxBA,CARA;AAiCJgB,IAAAA,KAAK,GAAGf,EAAE,GAAG;AACLgB,MAAAA,KAAK,EAAE,KADF;AAELC,MAAAA,UAAU,EAAE;AAFP,KAAL,EAIJjB,EAAE,CAACF,KAAK,CAACY,WAAN,CAAkBC,IAAlB,CAAuB,IAAvB,CAAD,CAAF,GAAmC;AAAEL,MAAAA,OAAO,EAAE;AAAX,KAJ/B,EAKJN,EALC,CAjCD;AAuCJkB,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE;AAAR,KAvCF;AAwCJC,IAAAA,MAAM,EAAE;AACJH,MAAAA,UAAU,EAAE;AADR,KAxCJ;AA2CJI,IAAAA,QAAQ,EAAE;AACNC,MAAAA,WAAW,EAAExB,KAAK,CAACyB,OAAN,CAAc,CAAd;AADP;AA3CN,GAAR;AA+CH,CAjDyB,EAiDvB;AAAEC,EAAAA,IAAI,EAAE;AAAR,CAjDuB,CAA1B;;AAkDA,IAAIC,gBAAgB,GAAG,UAAUC,KAAV,EAAiB;AACpC,MAAIC,OAAO,GAAG9B,SAAS,CAAC6B,KAAD,CAAvB;AACA,MAAIE,SAAS,GAAGnC,YAAY,EAA5B;AACA,SAAQf,KAAK,CAACmD,aAAN,CAAoBzC,MAApB,EAA4BxB,QAAQ,CAAC;AAAEkE,IAAAA,IAAI,EAAE;AAAR,GAAD,EAAoBJ,KAApB,CAApC,EACJhD,KAAK,CAACmD,aAAN,CAAoBrC,OAApB,EAA6B;AAAEuC,IAAAA,SAAS,EAAEJ,OAAO,CAACN;AAArB,GAA7B,CADI,EAEJO,SAAS,CAAC,eAAD,CAFL,CAAR;AAGH,CAND;;AAOA,IAAII,mBAAmB,GAAG,UAAUN,KAAV,EAAiB;AACvC,MAAIC,OAAO,GAAG9B,SAAS,CAAC6B,KAAD,CAAvB;AACA,MAAIE,SAAS,GAAGnC,YAAY,EAA5B;AACA,SAAQf,KAAK,CAACmD,aAAN,CAAoBzC,MAApB,EAA4BxB,QAAQ,CAAC;AAAEkE,IAAAA,IAAI,EAAE;AAAR,GAAD,EAAoBJ,KAApB,CAApC,EACJhD,KAAK,CAACmD,aAAN,CAAoBtC,SAApB,EAA+B;AAAEwC,IAAAA,SAAS,EAAEJ,OAAO,CAACN;AAArB,GAA/B,CADI,EAEJO,SAAS,CAAC,kBAAD,CAFL,CAAR;AAGH,CAND;;AAOA,IAAIK,kBAAkB,GAAG,UAAUP,KAAV,EAAiB;AACtC,MAAI3B,EAAE,GAAG2B,KAAK,CAACQ,SAAf;AAAA,MAA0BA,SAAS,GAAGnC,EAAE,KAAK,KAAK,CAAZ,GAAgBrB,KAAK,CAACmD,aAAN,CAAoBJ,gBAApB,EAAsC,IAAtC,CAAhB,GAA8D1B,EAApG;AAAA,MAAwGC,EAAE,GAAG0B,KAAK,CAACS,YAAnH;AAAA,MAAiIA,YAAY,GAAGnC,EAAE,KAAK,KAAK,CAAZ,GAAgBtB,KAAK,CAACmD,aAAN,CAAoBG,mBAApB,EAAyC,IAAzC,CAAhB,GAAiEhC,EAAjN;AAAA,MAAqNoC,QAAQ,GAAGV,KAAK,CAACU,QAAtO;AAAA,MAAgPC,QAAQ,GAAGX,KAAK,CAACW,QAAjQ;AAAA,MAA2QC,MAAM,GAAGZ,KAAK,CAACY,MAA1R;AAAA,MAAkSC,EAAE,GAAGb,KAAK,CAACc,IAA7S;AAAA,MAAmTC,KAAK,GAAGF,EAAE,CAACE,KAA9T;AAAA,MAAqUC,YAAY,GAAGH,EAAE,CAACG,YAAvV;AAAA,MAAqWC,MAAM,GAAGjB,KAAK,CAACiB,MAApX;AAAA,MAA4XC,QAAQ,GAAGlB,KAAK,CAACkB,QAA7Y;AAAA,MAAuZC,MAAM,GAAGnB,KAAK,CAACmB,MAAta;AAAA,MAA8aC,UAAU,GAAGpB,KAAK,CAACoB,UAAjc;AAAA,MAA6cC,aAAa,GAAGrB,KAAK,CAACqB,aAAne;AAAA,MAAkfC,OAAO,GAAGtB,KAAK,CAACsB,OAAlgB;AAAA,MAA2gBC,MAAM,GAAGvB,KAAK,CAACuB,MAA1hB;AAAA,MAAkiBC,eAAe,GAAGxB,KAAK,CAACwB,eAA1jB;AAAA,MAA2kBC,YAAY,GAAGzB,KAAK,CAACyB,YAAhmB;AACA,MAAIxB,OAAO,GAAG9B,SAAS,CAAC6B,KAAD,CAAvB,CAFsC,CAGtC;AACA;;AACA,MAAI0B,MAAM,GAAGtE,MAAM,CAACwD,MAAM,IAAIA,MAAM,CAAClE,MAAjB,GACdkE,MAAM,CAAClE,MADO,GAEd+E,YAAY,GACRA,YAAY,CAAC/E,MADL,GAER,CAJS,CAAnB,CALsC,CAUtC;AACA;AACA;AACA;;AACA,MAAIiF,GAAG,GAAGvE,MAAM,CAACsE,MAAM,CAACE,OAAP,GAAiB,CAAjB,GAAqBC,KAAK,CAACC,IAAN,CAAWD,KAAK,CAACH,MAAM,CAACE,OAAR,CAAL,CAAsBG,IAAtB,EAAX,CAArB,GAAgE,EAAjE,CAAhB;;AACA,MAAIC,WAAW,GAAG,UAAU3C,KAAV,EAAiB;AAAE,WAAO,YAAY;AACpDsC,MAAAA,GAAG,CAACC,OAAJ,CAAYK,MAAZ,CAAmB5C,KAAnB,EAA0B,CAA1B;AACAuB,MAAAA,MAAM,CAACsB,MAAP,CAAc7C,KAAd;AACH,KAHoC;AAGjC,GAHJ,CAfsC,CAmBtC;AACA;AACA;AACA;;;AACA,MAAI8C,kBAAkB,GAAG,UAAUlB,MAAV,EAAkBI,aAAlB,EAAiC;AACtD,QAAI,OAAOA,aAAP,KAAyB,SAA7B,EAAwC;AACpC,aAAOA,aAAP;AACH;;AACD,WAAOA,aAAa,IAAIA,aAAa,CAACJ,MAAD,CAArC;AACH,GALD;;AAMA,MAAImB,QAAQ,GAAG,YAAY;AACvBT,IAAAA,GAAG,CAACC,OAAJ,CAAYS,IAAZ,CAAiBX,MAAM,CAACE,OAAP,EAAjB;AACAhB,IAAAA,MAAM,CAACyB,IAAP,CAAYC,SAAZ;AACH,GAHD,CA7BsC,CAiCtC;;;AACA,MAAIC,oBAAoB,GAAG,UAAUC,sBAAV,EAAkC;AAAE,WAAO,UAAUC,KAAV,EAAiB;AACnFL,MAAAA,QAAQ;;AACR,UAAII,sBAAJ,EAA4B;AACxBA,QAAAA,sBAAsB,CAACC,KAAD,CAAtB;AACH;AACJ,KAL8D;AAK3D,GALJ,CAlCsC,CAwCtC;;;AACA,MAAIC,uBAAuB,GAAG,UAAUF,sBAAV,EAAkCnD,KAAlC,EAAyC;AAAE,WAAO,UAAUoD,KAAV,EAAiB;AAC7FT,MAAAA,WAAW,CAAC3C,KAAD,CAAX;;AACA,UAAImD,sBAAJ,EAA4B;AACxBA,QAAAA,sBAAsB,CAACC,KAAD,CAAtB;AACH;AACJ,KALwE;AAKrE,GALJ;;AAMA,MAAIE,OAAO,GAAGnF,GAAG,CAACyD,MAAD,EAASE,MAAT,CAAjB;AACA,SAAOP,MAAM,GAAI5D,KAAK,CAACmD,aAAN,CAAoB,IAApB,EAA0B;AAAEE,IAAAA,SAAS,EAAEJ,OAAO,CAAC1B;AAArB,GAA1B,EACbyC,YAAY,IAAI,OAAOD,KAAP,KAAiB,QAAjC,IAA6CA,KAA7C,IAAuD/D,KAAK,CAACmD,aAAN,CAAoBxC,cAApB,EAAoC;AAAEoD,IAAAA,KAAK,EAAE;AAAT,GAApC,EACnD/D,KAAK,CAACmD,aAAN,CAAoBnC,eAApB,EAAqC;AAAE+C,IAAAA,KAAK,EAAEA;AAAT,GAArC,CADmD,CAD1C,EAGb/D,KAAK,CAACmD,aAAN,CAAoB5C,eAApB,EAAqC;AAAEqF,IAAAA,SAAS,EAAE;AAAb,GAArC,EAA0DhC,MAAM,CAACiC,GAAP,CAAW,UAAUC,MAAV,EAAkBzD,KAAlB,EAAyB;AAAE,WAAQrC,KAAK,CAACmD,aAAN,CAAoB7C,aAApB,EAAmCpB,QAAQ,CAAC;AAAE6G,MAAAA,GAAG,EAAEpB,GAAG,CAACC,OAAJ,CAAYvC,KAAZ,CAAP;AAA2B2D,MAAAA,OAAO,EAAE,GAApC;AAAyC/E,MAAAA,UAAU,EAAE;AAArD,KAAD,EAAgEuD,eAAhE,CAA3C,EACpGxE,KAAK,CAACmD,aAAN,CAAoB,IAApB,EAA0B;AAAEE,MAAAA,SAAS,EAAEJ,OAAO,CAACtB;AAArB,KAA1B,EACI3B,KAAK,CAACmD,aAAN,CAAoB1C,UAApB,EAAgC;AAAE6D,MAAAA,OAAO,EAAE,OAAX;AAAoBjB,MAAAA,SAAS,EAAEJ,OAAO,CAACZ;AAAvC,KAAhC,EAAgFA,KAAK,GAAG,CAAxF,CADJ,EAEIrC,KAAK,CAACmD,aAAN,CAAoB,SAApB,EAA+B;AAAEE,MAAAA,SAAS,EAAEJ,OAAO,CAACT;AAArB,KAA/B,EAA4DvC,QAAQ,CAAC4F,GAAT,CAAalC,QAAb,EAAuB,UAAUsC,KAAV,EAAiBC,MAAjB,EAAyB;AACxG,aAAO/F,cAAc,CAAC8F,KAAD,CAAd,GAAyBjG,KAAK,CAACmD,aAAN,CAAoBjC,SAApB,EAA+B;AAAEwC,QAAAA,QAAQ,EAAEuC,KAAK,CAACjD,KAAN,CAAYU,QAAZ,IACnEA,QADuD;AAC7CuC,QAAAA,KAAK,EAAE/F,YAAY,CAAC+F,KAAD,EAAQ;AACrC9B,UAAAA,MAAM,EAAE8B,KAAK,CAACjD,KAAN,CAAYmB,MAAZ,GACF2B,MAAM,GAAG,GAAT,GAAeG,KAAK,CAACjD,KAAN,CAAYmB,MADzB,GAEF2B,MAH+B;AAIrCzD,UAAAA,KAAK,EAAE4D,KAAK,CAACjD,KAAN,CAAYmB,MAAZ,GACDmB,SADC,GAEDY,MAN+B;AAOrCC,UAAAA,KAAK,EAAE,OAAOF,KAAK,CAACjD,KAAN,CACTmD,KADE,KAEH,WAFG,GAGDF,KAAK,CAACjD,KAAN,CAAYmB,MAAZ,GACI,eAAeD,QAAf,GAA0B,UAA1B,GAAuC+B,KAAK,CAACjD,KAAN,CAAYmB,MADvD,GAEImB,SALH,GAMDW,KAAK,CAACjD,KAAN,CAAYmD;AAbmB,SAAR,CAD0B;AAevDlC,QAAAA,MAAM,EAAG0B,OAAO,IAChBA,OAAO,CAACtD,KAAD,CADC,IAER,EAjBuD;AAiBnD6B,QAAAA,QAAQ,EAAEA,QAjByC;AAiB/BI,QAAAA,OAAO,EAAEA,OAjBsB;AAiBbC,QAAAA,MAAM,EAAEA;AAjBK,OAA/B,CAAzB,GAiBgE,IAjBvE;AAkBH,KAnB2D,CAA5D,CAFJ,EAsBI,CAACY,kBAAkB,CAAEQ,OAAO,IAAIA,OAAO,CAACtD,KAAD,CAAnB,IAA+B,EAAhC,EAAoCgC,aAApC,CAAnB,IAA0ErE,KAAK,CAACmD,aAAN,CAAoB,MAApB,EAA4B;AAAEE,MAAAA,SAAS,EAAEJ,OAAO,CAACP;AAArB,KAA5B,EAA2DxC,YAAY,CAACuD,YAAD,EAAe;AAC5J2C,MAAAA,OAAO,EAAEV,uBAAuB,CAACjC,YAAY,CAACT,KAAb,CAAmBoD,OAApB,EAA6B/D,KAA7B,CAD4H;AAE5JgB,MAAAA,SAAS,EAAEpC,UAAU,CAAC,eAAD,EAAkB,mBAAmBkD,MAAnB,GAA4B,GAA5B,GAAkC9B,KAApD;AAFuI,KAAf,CAAvE,CAtB9E,CADoG,CAAR;AA0B9E,GA1BwC,CAA1D,CAHa,EA8Bb,CAAC+B,UAAD,IAAgBpE,KAAK,CAACmD,aAAN,CAAoB,IAApB,EAA0B;AAAEE,IAAAA,SAAS,EAAEJ,OAAO,CAACtB;AAArB,GAA1B,EACZ3B,KAAK,CAACmD,aAAN,CAAoB,MAApB,EAA4B;AAAEE,IAAAA,SAAS,EAAEJ,OAAO,CAACP;AAArB,GAA5B,EAA2DxC,YAAY,CAACsD,SAAD,EAAY;AAC/E4C,IAAAA,OAAO,EAAEb,oBAAoB,CAAC/B,SAAS,CAACR,KAAV,CAAgBoD,OAAjB,CADkD;AAE/E/C,IAAAA,SAAS,EAAEpC,UAAU,CAAC,YAAD,EAAe,gBAAgBkD,MAA/B;AAF0D,GAAZ,CAAvE,CADY,CA9BH,CAAJ,GAkCK,IAlClB;AAmCH,CAnFD;;AAoFAZ,kBAAkB,CAAC8C,YAAnB,GAAkC;AAC9BjC,EAAAA,UAAU,EAAE,KADkB;AAE9BC,EAAAA,aAAa,EAAE;AAFe,CAAlC;AAIAd,kBAAkB,CAAC+C,SAAnB,GAA+B;AAC3B7B,EAAAA,YAAY,EAAEpE,SAAS,CAACkG,GADG;AAE3B/C,EAAAA,SAAS,EAAEnD,SAAS,CAACmG,OAFM;AAG3B/C,EAAAA,YAAY,EAAEpD,SAAS,CAACmG,OAHG;AAI3B9C,EAAAA,QAAQ,EAAErD,SAAS,CAACoG,MAJO;AAK3B9C,EAAAA,QAAQ,EAAEtD,SAAS,CAACqG,IALO;AAM3BzD,EAAAA,OAAO,EAAE5C,SAAS,CAACsG,MANQ;AAO3BtD,EAAAA,SAAS,EAAEhD,SAAS,CAACoG,MAPM;AAQ3B;AACA7C,EAAAA,MAAM,EAAEvD,SAAS,CAACsG,MATS;AAU3B7C,EAAAA,IAAI,EAAEzD,SAAS,CAACsG,MAVW;AAW3B;AACA1C,EAAAA,MAAM,EAAE5D,SAAS,CAACsG,MAZS;AAa3BxC,EAAAA,MAAM,EAAE9D,SAAS,CAACoG,MAbS;AAc3BvC,EAAAA,QAAQ,EAAE7D,SAAS,CAACoG,MAdO;AAe3BvD,EAAAA,SAAS,EAAE7C,SAAS,CAACuG,IAfM;AAgB3BxC,EAAAA,UAAU,EAAE/D,SAAS,CAACwG,IAhBK;AAiB3BxC,EAAAA,aAAa,EAAEhE,SAAS,CAACyG,SAAV,CAAoB,CAACzG,SAAS,CAACuG,IAAX,EAAiBvG,SAAS,CAACwG,IAA3B,CAApB,CAjBY;AAkB3BrC,EAAAA,eAAe,EAAEnE,SAAS,CAAC0G,KAAV,CAAgB,EAAhB;AAlBU,CAA/B;AAoBA,eAAexD,kBAAf","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport { Children, cloneElement, isValidElement, useRef, } from 'react';\nimport PropTypes from 'prop-types';\nimport { CSSTransition, TransitionGroup } from 'react-transition-group';\nimport get from 'lodash/get';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CloseIcon from '@material-ui/icons/RemoveCircleOutline';\nimport AddIcon from '@material-ui/icons/AddCircleOutline';\nimport { useTranslate, ValidationError } from 'ra-core';\nimport classNames from 'classnames';\nimport FormInput from './FormInput';\nvar useStyles = makeStyles(function (theme) {\n    var _a, _b;\n    return ({\n        root: {\n            padding: 0,\n            marginBottom: 0,\n            '& > li:last-child': {\n                borderBottom: 'none',\n            },\n        },\n        line: (_a = {\n                display: 'flex',\n                listStyleType: 'none',\n                borderBottom: \"solid 1px \" + theme.palette.divider\n            },\n            _a[theme.breakpoints.down('xs')] = { display: 'block' },\n            _a['&.fade-enter'] = {\n                opacity: 0.01,\n                transform: 'translateX(100vw)',\n            },\n            _a['&.fade-enter-active'] = {\n                opacity: 1,\n                transform: 'translateX(0)',\n                transition: 'all 500ms ease-in',\n            },\n            _a['&.fade-exit'] = {\n                opacity: 1,\n                transform: 'translateX(0)',\n            },\n            _a['&.fade-exit-active'] = {\n                opacity: 0.01,\n                transform: 'translateX(100vw)',\n                transition: 'all 500ms ease-in',\n            },\n            _a),\n        index: (_b = {\n                width: '3em',\n                paddingTop: '1em'\n            },\n            _b[theme.breakpoints.down('sm')] = { display: 'none' },\n            _b),\n        form: { flex: 2 },\n        action: {\n            paddingTop: '0.5em',\n        },\n        leftIcon: {\n            marginRight: theme.spacing(1),\n        },\n    });\n}, { name: 'RaSimpleFormIterator' });\nvar DefaultAddButton = function (props) {\n    var classes = useStyles(props);\n    var translate = useTranslate();\n    return (React.createElement(Button, __assign({ size: \"small\" }, props),\n        React.createElement(AddIcon, { className: classes.leftIcon }),\n        translate('ra.action.add')));\n};\nvar DefaultRemoveButton = function (props) {\n    var classes = useStyles(props);\n    var translate = useTranslate();\n    return (React.createElement(Button, __assign({ size: \"small\" }, props),\n        React.createElement(CloseIcon, { className: classes.leftIcon }),\n        translate('ra.action.remove')));\n};\nvar SimpleFormIterator = function (props) {\n    var _a = props.addButton, addButton = _a === void 0 ? React.createElement(DefaultAddButton, null) : _a, _b = props.removeButton, removeButton = _b === void 0 ? React.createElement(DefaultRemoveButton, null) : _b, basePath = props.basePath, children = props.children, fields = props.fields, _c = props.meta, error = _c.error, submitFailed = _c.submitFailed, record = props.record, resource = props.resource, source = props.source, disableAdd = props.disableAdd, disableRemove = props.disableRemove, variant = props.variant, margin = props.margin, TransitionProps = props.TransitionProps, defaultValue = props.defaultValue;\n    var classes = useStyles(props);\n    // We need a unique id for each field for a proper enter/exit animation\n    // so we keep an internal map between the field position and an auto-increment id\n    var nextId = useRef(fields && fields.length\n        ? fields.length\n        : defaultValue\n            ? defaultValue.length\n            : 0);\n    // We check whether we have a defaultValue (which must be an array) before checking\n    // the fields prop which will always be empty for a new record.\n    // Without it, our ids wouldn't match the default value and we would get key warnings\n    // on the CssTransition element inside our render method\n    var ids = useRef(nextId.current > 0 ? Array.from(Array(nextId.current).keys()) : []);\n    var removeField = function (index) { return function () {\n        ids.current.splice(index, 1);\n        fields.remove(index);\n    }; };\n    // Returns a boolean to indicate whether to disable the remove button for certain fields.\n    // If disableRemove is a function, then call the function with the current record to\n    // determining if the button should be disabled. Otherwise, use a boolean property that\n    // enables or disables the button for all of the fields.\n    var disableRemoveField = function (record, disableRemove) {\n        if (typeof disableRemove === 'boolean') {\n            return disableRemove;\n        }\n        return disableRemove && disableRemove(record);\n    };\n    var addField = function () {\n        ids.current.push(nextId.current++);\n        fields.push(undefined);\n    };\n    // add field and call the onClick event of the button passed as addButton prop\n    var handleAddButtonClick = function (originalOnClickHandler) { return function (event) {\n        addField();\n        if (originalOnClickHandler) {\n            originalOnClickHandler(event);\n        }\n    }; };\n    // remove field and call the onClick event of the button passed as removeButton prop\n    var handleRemoveButtonClick = function (originalOnClickHandler, index) { return function (event) {\n        removeField(index)();\n        if (originalOnClickHandler) {\n            originalOnClickHandler(event);\n        }\n    }; };\n    var records = get(record, source);\n    return fields ? (React.createElement(\"ul\", { className: classes.root },\n        submitFailed && typeof error !== 'object' && error && (React.createElement(FormHelperText, { error: true },\n            React.createElement(ValidationError, { error: error }))),\n        React.createElement(TransitionGroup, { component: null }, fields.map(function (member, index) { return (React.createElement(CSSTransition, __assign({ key: ids.current[index], timeout: 500, classNames: \"fade\" }, TransitionProps),\n            React.createElement(\"li\", { className: classes.line },\n                React.createElement(Typography, { variant: \"body1\", className: classes.index }, index + 1),\n                React.createElement(\"section\", { className: classes.form }, Children.map(children, function (input, index2) {\n                    return isValidElement(input) ? (React.createElement(FormInput, { basePath: input.props.basePath ||\n                            basePath, input: cloneElement(input, {\n                            source: input.props.source\n                                ? member + \".\" + input.props.source\n                                : member,\n                            index: input.props.source\n                                ? undefined\n                                : index2,\n                            label: typeof input.props\n                                .label ===\n                                'undefined'\n                                ? input.props.source\n                                    ? \"resources.\" + resource + \".fields.\" + input.props.source\n                                    : undefined\n                                : input.props.label,\n                        }), record: (records &&\n                            records[index]) ||\n                            {}, resource: resource, variant: variant, margin: margin })) : null;\n                })),\n                !disableRemoveField((records && records[index]) || {}, disableRemove) && (React.createElement(\"span\", { className: classes.action }, cloneElement(removeButton, {\n                    onClick: handleRemoveButtonClick(removeButton.props.onClick, index),\n                    className: classNames('button-remove', \"button-remove-\" + source + \"-\" + index),\n                })))))); })),\n        !disableAdd && (React.createElement(\"li\", { className: classes.line },\n            React.createElement(\"span\", { className: classes.action }, cloneElement(addButton, {\n                onClick: handleAddButtonClick(addButton.props.onClick),\n                className: classNames('button-add', \"button-add-\" + source),\n            })))))) : null;\n};\nSimpleFormIterator.defaultProps = {\n    disableAdd: false,\n    disableRemove: false,\n};\nSimpleFormIterator.propTypes = {\n    defaultValue: PropTypes.any,\n    addButton: PropTypes.element,\n    removeButton: PropTypes.element,\n    basePath: PropTypes.string,\n    children: PropTypes.node,\n    classes: PropTypes.object,\n    className: PropTypes.string,\n    // @ts-ignore\n    fields: PropTypes.object,\n    meta: PropTypes.object,\n    // @ts-ignore\n    record: PropTypes.object,\n    source: PropTypes.string,\n    resource: PropTypes.string,\n    translate: PropTypes.func,\n    disableAdd: PropTypes.bool,\n    disableRemove: PropTypes.oneOfType([PropTypes.func, PropTypes.bool]),\n    TransitionProps: PropTypes.shape({}),\n};\nexport default SimpleFormIterator;\n"]},"metadata":{},"sourceType":"module"}