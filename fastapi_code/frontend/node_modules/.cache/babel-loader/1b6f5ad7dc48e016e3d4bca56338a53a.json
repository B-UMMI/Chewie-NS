{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n};\n\nimport React, { Children, cloneElement, isValidElement } from 'react';\nimport PropTypes from 'prop-types';\nimport { shallowEqual } from 'react-redux';\nimport { useDropzone } from 'react-dropzone';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport classnames from 'classnames';\nimport { useInput, useTranslate } from 'ra-core';\nimport Labeled from './Labeled';\nimport FileInputPreview from './FileInputPreview';\nimport sanitizeRestProps from './sanitizeRestProps';\nimport InputHelperText from './InputHelperText';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    dropZone: {\n      background: theme.palette.background.default,\n      cursor: 'pointer',\n      padding: theme.spacing(1),\n      textAlign: 'center',\n      color: theme.palette.getContrastText(theme.palette.background.default)\n    },\n    preview: {},\n    removeButton: {},\n    root: {\n      width: '100%'\n    }\n  };\n}, {\n  name: 'RaFileInput'\n});\n\nvar FileInput = function (props) {\n  var accept = props.accept,\n      children = props.children,\n      className = props.className,\n      classesOverride = props.classes,\n      format = props.format,\n      helperText = props.helperText,\n      label = props.label,\n      _a = props.labelMultiple,\n      labelMultiple = _a === void 0 ? 'ra.input.file.upload_several' : _a,\n      _b = props.labelSingle,\n      labelSingle = _b === void 0 ? 'ra.input.file.upload_single' : _b,\n      maxSize = props.maxSize,\n      minSize = props.minSize,\n      _c = props.multiple,\n      multiple = _c === void 0 ? false : _c,\n      _d = props.options,\n      _e = _d === void 0 ? {} : _d,\n      inputPropsOptions = _e.inputProps,\n      options = __rest(_e, [\"inputProps\"]),\n      parse = props.parse,\n      placeholder = props.placeholder,\n      resource = props.resource,\n      source = props.source,\n      validate = props.validate,\n      rest = __rest(props, [\"accept\", \"children\", \"className\", \"classes\", \"format\", \"helperText\", \"label\", \"labelMultiple\", \"labelSingle\", \"maxSize\", \"minSize\", \"multiple\", \"options\", \"parse\", \"placeholder\", \"resource\", \"source\", \"validate\"]);\n\n  var translate = useTranslate();\n  var classes = useStyles(props); // turn a browser dropped file structure into expected structure\n\n  var transformFile = function (file) {\n    var _a;\n\n    if (!(file instanceof File)) {\n      return file;\n    }\n\n    var _b = Children.only(children).props,\n        source = _b.source,\n        title = _b.title;\n    var preview = URL.createObjectURL(file);\n    var transformedFile = (_a = {\n      rawFile: file\n    }, _a[source] = preview, _a);\n\n    if (title) {\n      transformedFile[title] = file.name;\n    }\n\n    return transformedFile;\n  };\n\n  var transformFiles = function (files) {\n    if (!files) {\n      return multiple ? [] : null;\n    }\n\n    if (Array.isArray(files)) {\n      return files.map(transformFile);\n    }\n\n    return transformFile(files);\n  };\n\n  var _f = useInput(__assign({\n    format: format || transformFiles,\n    parse: parse || transformFiles,\n    source: source,\n    type: 'file',\n    validate: validate\n  }, rest)),\n      id = _f.id,\n      _g = _f.input,\n      onChange = _g.onChange,\n      value = _g.value,\n      inputProps = __rest(_g, [\"onChange\", \"value\"]),\n      meta = _f.meta,\n      isRequired = _f.isRequired;\n\n  var touched = meta.touched,\n      error = meta.error;\n  var files = value ? Array.isArray(value) ? value : [value] : [];\n\n  var onDrop = function (newFiles, rejectedFiles, event) {\n    var updatedFiles = multiple ? __spreadArrays(files, newFiles) : __spreadArrays(newFiles);\n\n    if (multiple) {\n      onChange(updatedFiles);\n    } else {\n      onChange(updatedFiles[0]);\n    }\n\n    if (options.onDrop) {\n      options.onDrop(newFiles, rejectedFiles, event);\n    }\n  };\n\n  var onRemove = function (file) {\n    return function () {\n      if (multiple) {\n        var filteredFiles = files.filter(function (stateFile) {\n          return !shallowEqual(stateFile, file);\n        });\n        onChange(filteredFiles);\n      } else {\n        onChange(null);\n      }\n\n      if (options.onRemove) {\n        options.onRemove(file);\n      }\n    };\n  };\n\n  var childrenElement = children && isValidElement(Children.only(children)) ? Children.only(children) : undefined;\n\n  var _h = useDropzone(__assign(__assign({}, options), {\n    accept: accept,\n    maxSize: maxSize,\n    minSize: minSize,\n    multiple: multiple,\n    onDrop: onDrop\n  })),\n      getRootProps = _h.getRootProps,\n      getInputProps = _h.getInputProps;\n\n  return React.createElement(Labeled, __assign({\n    id: id,\n    label: label,\n    className: classnames(classes.root, className),\n    source: source,\n    resource: resource,\n    isRequired: isRequired,\n    meta: meta\n  }, sanitizeRestProps(rest)), React.createElement(React.Fragment, null, React.createElement(\"div\", __assign({\n    \"data-testid\": \"dropzone\",\n    className: classes.dropZone\n  }, getRootProps()), React.createElement(\"input\", __assign({\n    id: id\n  }, getInputProps(__assign(__assign({}, inputProps), inputPropsOptions)))), placeholder ? placeholder : multiple ? React.createElement(\"p\", null, translate(labelMultiple)) : React.createElement(\"p\", null, translate(labelSingle))), React.createElement(FormHelperText, null, React.createElement(InputHelperText, {\n    touched: touched,\n    error: error,\n    helperText: helperText\n  })), children && React.createElement(\"div\", {\n    className: \"previews\"\n  }, files.map(function (file, index) {\n    return React.createElement(FileInputPreview, {\n      key: index,\n      file: file,\n      onRemove: onRemove(file),\n      className: classes.removeButton\n    }, cloneElement(childrenElement, {\n      record: file,\n      className: classes.preview\n    }));\n  }))));\n};\n\nFileInput.propTypes = {\n  accept: PropTypes.string,\n  children: PropTypes.element,\n  classes: PropTypes.object,\n  className: PropTypes.string,\n  id: PropTypes.string,\n  isRequired: PropTypes.bool,\n  label: PropTypes.string,\n  labelMultiple: PropTypes.string,\n  labelSingle: PropTypes.string,\n  maxSize: PropTypes.number,\n  minSize: PropTypes.number,\n  multiple: PropTypes.bool,\n  options: PropTypes.object,\n  resource: PropTypes.string,\n  source: PropTypes.string,\n  placeholder: PropTypes.node\n};\nexport default FileInput;","map":{"version":3,"sources":["/node_modules/ra-ui-materialui/esm/input/FileInput.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__spreadArrays","il","r","Array","k","a","j","jl","React","Children","cloneElement","isValidElement","PropTypes","shallowEqual","useDropzone","makeStyles","FormHelperText","classnames","useInput","useTranslate","Labeled","FileInputPreview","sanitizeRestProps","InputHelperText","useStyles","theme","dropZone","background","palette","default","cursor","padding","spacing","textAlign","color","getContrastText","preview","removeButton","root","width","name","FileInput","props","accept","children","className","classesOverride","classes","format","helperText","label","_a","labelMultiple","_b","labelSingle","maxSize","minSize","_c","multiple","_d","options","_e","inputPropsOptions","inputProps","parse","placeholder","resource","source","validate","rest","translate","transformFile","file","File","only","title","URL","createObjectURL","transformedFile","rawFile","transformFiles","files","isArray","map","_f","type","id","_g","input","onChange","value","meta","isRequired","touched","error","onDrop","newFiles","rejectedFiles","event","updatedFiles","onRemove","filteredFiles","filter","stateFile","childrenElement","undefined","_h","getRootProps","getInputProps","createElement","Fragment","index","key","record","propTypes","string","element","object","bool","number","node"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport React, { Children, cloneElement, isValidElement, } from 'react';\nimport PropTypes from 'prop-types';\nimport { shallowEqual } from 'react-redux';\nimport { useDropzone } from 'react-dropzone';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport classnames from 'classnames';\nimport { useInput, useTranslate } from 'ra-core';\nimport Labeled from './Labeled';\nimport FileInputPreview from './FileInputPreview';\nimport sanitizeRestProps from './sanitizeRestProps';\nimport InputHelperText from './InputHelperText';\nvar useStyles = makeStyles(function (theme) { return ({\n    dropZone: {\n        background: theme.palette.background.default,\n        cursor: 'pointer',\n        padding: theme.spacing(1),\n        textAlign: 'center',\n        color: theme.palette.getContrastText(theme.palette.background.default),\n    },\n    preview: {},\n    removeButton: {},\n    root: { width: '100%' },\n}); }, { name: 'RaFileInput' });\nvar FileInput = function (props) {\n    var accept = props.accept, children = props.children, className = props.className, classesOverride = props.classes, format = props.format, helperText = props.helperText, label = props.label, _a = props.labelMultiple, labelMultiple = _a === void 0 ? 'ra.input.file.upload_several' : _a, _b = props.labelSingle, labelSingle = _b === void 0 ? 'ra.input.file.upload_single' : _b, maxSize = props.maxSize, minSize = props.minSize, _c = props.multiple, multiple = _c === void 0 ? false : _c, _d = props.options, _e = _d === void 0 ? {} : _d, inputPropsOptions = _e.inputProps, options = __rest(_e, [\"inputProps\"]), parse = props.parse, placeholder = props.placeholder, resource = props.resource, source = props.source, validate = props.validate, rest = __rest(props, [\"accept\", \"children\", \"className\", \"classes\", \"format\", \"helperText\", \"label\", \"labelMultiple\", \"labelSingle\", \"maxSize\", \"minSize\", \"multiple\", \"options\", \"parse\", \"placeholder\", \"resource\", \"source\", \"validate\"]);\n    var translate = useTranslate();\n    var classes = useStyles(props);\n    // turn a browser dropped file structure into expected structure\n    var transformFile = function (file) {\n        var _a;\n        if (!(file instanceof File)) {\n            return file;\n        }\n        var _b = Children.only(children).props, source = _b.source, title = _b.title;\n        var preview = URL.createObjectURL(file);\n        var transformedFile = (_a = {\n                rawFile: file\n            },\n            _a[source] = preview,\n            _a);\n        if (title) {\n            transformedFile[title] = file.name;\n        }\n        return transformedFile;\n    };\n    var transformFiles = function (files) {\n        if (!files) {\n            return multiple ? [] : null;\n        }\n        if (Array.isArray(files)) {\n            return files.map(transformFile);\n        }\n        return transformFile(files);\n    };\n    var _f = useInput(__assign({ format: format || transformFiles, parse: parse || transformFiles, source: source, type: 'file', validate: validate }, rest)), id = _f.id, _g = _f.input, onChange = _g.onChange, value = _g.value, inputProps = __rest(_g, [\"onChange\", \"value\"]), meta = _f.meta, isRequired = _f.isRequired;\n    var touched = meta.touched, error = meta.error;\n    var files = value ? (Array.isArray(value) ? value : [value]) : [];\n    var onDrop = function (newFiles, rejectedFiles, event) {\n        var updatedFiles = multiple ? __spreadArrays(files, newFiles) : __spreadArrays(newFiles);\n        if (multiple) {\n            onChange(updatedFiles);\n        }\n        else {\n            onChange(updatedFiles[0]);\n        }\n        if (options.onDrop) {\n            options.onDrop(newFiles, rejectedFiles, event);\n        }\n    };\n    var onRemove = function (file) { return function () {\n        if (multiple) {\n            var filteredFiles = files.filter(function (stateFile) { return !shallowEqual(stateFile, file); });\n            onChange(filteredFiles);\n        }\n        else {\n            onChange(null);\n        }\n        if (options.onRemove) {\n            options.onRemove(file);\n        }\n    }; };\n    var childrenElement = children && isValidElement(Children.only(children))\n        ? Children.only(children)\n        : undefined;\n    var _h = useDropzone(__assign(__assign({}, options), { accept: accept,\n        maxSize: maxSize,\n        minSize: minSize,\n        multiple: multiple,\n        onDrop: onDrop })), getRootProps = _h.getRootProps, getInputProps = _h.getInputProps;\n    return (React.createElement(Labeled, __assign({ id: id, label: label, className: classnames(classes.root, className), source: source, resource: resource, isRequired: isRequired, meta: meta }, sanitizeRestProps(rest)),\n        React.createElement(React.Fragment, null,\n            React.createElement(\"div\", __assign({ \"data-testid\": \"dropzone\", className: classes.dropZone }, getRootProps()),\n                React.createElement(\"input\", __assign({ id: id }, getInputProps(__assign(__assign({}, inputProps), inputPropsOptions)))),\n                placeholder ? (placeholder) : multiple ? (React.createElement(\"p\", null, translate(labelMultiple))) : (React.createElement(\"p\", null, translate(labelSingle)))),\n            React.createElement(FormHelperText, null,\n                React.createElement(InputHelperText, { touched: touched, error: error, helperText: helperText })),\n            children && (React.createElement(\"div\", { className: \"previews\" }, files.map(function (file, index) { return (React.createElement(FileInputPreview, { key: index, file: file, onRemove: onRemove(file), className: classes.removeButton }, cloneElement(childrenElement, {\n                record: file,\n                className: classes.preview,\n            }))); }))))));\n};\nFileInput.propTypes = {\n    accept: PropTypes.string,\n    children: PropTypes.element,\n    classes: PropTypes.object,\n    className: PropTypes.string,\n    id: PropTypes.string,\n    isRequired: PropTypes.bool,\n    label: PropTypes.string,\n    labelMultiple: PropTypes.string,\n    labelSingle: PropTypes.string,\n    maxSize: PropTypes.number,\n    minSize: PropTypes.number,\n    multiple: PropTypes.bool,\n    options: PropTypes.object,\n    resource: PropTypes.string,\n    source: PropTypes.string,\n    placeholder: PropTypes.node,\n};\nexport default FileInput;\n"]},"metadata":{},"sourceType":"module"}